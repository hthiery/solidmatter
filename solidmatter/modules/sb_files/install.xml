<?xml version="1.0" ?>
<sbXMLBatch>
	
	<move to="{SMBACKEND}/modules/sb_files">{BATCHDIR}/backend</move>
	<move to="{SMFRONTEND}/modules/sb_files">{BATCHDIR}/frontend</move>
	
	<repository action="add">
		
		<nodetype id="sbFiles:Filemanager" type="PRIMARY" displaytype="sb_jukebox" class="sbNode_files_filemanager" classfile="sbFiles:sb.node.filemanager" />
		<view nodetype="sbFiles:Filemanager" order="0" id="list" display="TRUE" class="sbView_list" classfile="sbSystem:sb.node.view.list" default="TRUE" />
		<view nodetype="sbFiles:Filemanager" order="1" id="properties" display="TRUE" class="sbView_properties" classfile="sbSystem:sb.node.view.properties" />
		<action nodetype="sbFiles:Filemanager" view="list" id="display" uselocale="TRUE" output="RENDERED" stylesheet="sbSystem:sb.node.list.xsl" mimetype="text/html" />
		<action nodetype="sbFiles:Filemanager" view="properties" id="edit" uselocale="TRUE" output="RENDERED" stylesheet="sbSystem:sb.node.properties.xsl" mimetype="text/html" default="TRUE" />
		<action nodetype="sbFiles:Filemanager" view="properties" id="save" uselocale="TRUE" output="RENDERED" stylesheet="sbSystem:sb.node.properties.xsl" mimetype="text/html" />
		
		<nodetype id="sbFiles:Folder" type="PRIMARY" taggable="TRUE" displaytype="sb_folder" class="sbNode_files_folder" classfile="sbFiles:sb.node.folder" />
		<view nodetype="sbFiles:Folder" order="0" id="thumbnails" display="TRUE" class="sbView_properties" classfile="sbSystem:sb.node.view.properties" />
		<view nodetype="sbFiles:Folder" order="1" id="list" display="TRUE" class="sbView_properties" classfile="sbSystem:sb.node.view.properties" default="TRUE" />
		<view nodetype="sbFiles:Folder" order="2" id="properties" display="TRUE" class="sbView_properties" classfile="sbSystem:sb.node.view.properties" />
		<view nodetype="sbFiles:Folder" order="3" id="upload" display="TRUE" class="sbView_folder_upload" classfile="sbFiles:sb.node.folder.view.upload" />
		<action nodetype="sbFiles:Folder" view="list" id="display" uselocale="TRUE" output="RENDERED" stylesheet="sbSystem:sb.node.list.xsl" mimetype="text/html" />
		<action nodetype="sbFiles:Folder" view="thumbnails" id="display" uselocale="TRUE" output="RENDERED" stylesheet="sbFiles:folder.thumbnails.xsl" mimetype="text/html" />
		<action nodetype="sbFiles:Folder" view="properties" id="edit" uselocale="TRUE" output="RENDERED" stylesheet="sbSystem:sb.node.properties.xsl" mimetype="text/html" default="TRUE" />
		<action nodetype="sbFiles:Folder" view="properties" id="save" uselocale="TRUE" output="RENDERED" stylesheet="sbSystem:sb.node.properties.xsl" mimetype="text/html" />
		<action nodetype="sbFiles:Folder" view="upload" id="display" uselocale="TRUE" output="RENDERED" stylesheet="sbFiles:folder.upload.xsl" mimetype="text/html" />
		<action nodetype="sbFiles:Folder" view="upload" id="send" uselocale="TRUE" output="RENDERED" stylesheet="sbFiles:folder.upload.xsl" mimetype="text/html" />
		<property nodetype="sbFiles:Folder" order="0" name="properties_description"type="STRING" internaltype="string" showinproperties="TRUE" labelpath="$locale/sbSystem/labels/description" storage="EXTERNAL" protected="FALSE" protectedoncreation="FALSE" multiple="FALSE" />
		<property nodetype="sbFiles:Folder" order="1" name="security_requireauthorisation" type="BOOLEAN" internaltype="checkbox" showinproperties="TRUE" labelpath="$locale/sbFiles/Folder/config_listingallowed/@label" storage="EXTERNAL" protected="FALSE" protectedoncreation="FALSE" multiple="FALSE" />
		<property nodetype="sbFiles:Folder" order="2" name="security_authuser" type="STRING" internaltype="string" showinproperties="TRUE" labelpath="$locale/sbSystem/labels/username" storage="EXTERNAL" protected="FALSE" protectedoncreation="FALSE" multiple="FALSE" />
		<property nodetype="sbFiles:Folder" order="3" name="security_authpassword" type="STRING" internaltype="string" showinproperties="TRUE" labelpath="$locale/sbSystem/labels/password" storage="EXTERNAL" protected="FALSE" protectedoncreation="FALSE" multiple="FALSE" />
		<property nodetype="sbFiles:Folder" order="4" name="config_types_allowed" type="STRING" internaltype="string" showinproperties="TRUE" labelpath="$locale/sbFiles/Folder/config_types_allowed/@label" storage="EXTERNAL" protected="FALSE" protectedoncreation="FALSE" multiple="FALSE" />
		<property nodetype="sbFiles:Folder" order="5" name="config_listingallowed" type="BOOLEAN" internaltype="checkbox" showinproperties="TRUE" labelpath="$locale/sbFiles/Folder/config_listingallowed/@label" storage="EXTERNAL" protected="FALSE" protectedoncreation="FALSE" multiple="FALSE" />
		
		<!--<nodetype id="sbFiles:Autofolder" type="PRIMARY" taggable="TRUE" displaytype="sb_folder" class="sbNode_files_autofolder" classfile="sbFiles:sb.node.autofolder" />-->
		
		<nodetype id="sbFiles:Asset" type="PRIMARY" taggable="TRUE" displaytype="sb_asset" />
		<view nodetype="sbFiles:Asset" order="1" id="properties" display="TRUE" class="sbView_properties" classfile="sbSystem:sb.node.view.properties" default="TRUE" />
		<view nodetype="sbFiles:Asset" id="render" display="TRUE" order="1" class="sbView_asset_render" classfile="sbFiles:sb.node.asset.view.render" />
		<action nodetype="sbFiles:Asset" view="properties" id="edit" uselocale="TRUE" output="RENDERED" stylesheet="sbSystem:sb.node.properties.xsl" mimetype="text/html" default="TRUE" />
		<action nodetype="sbFiles:Asset" view="properties" id="save" uselocale="TRUE" output="RENDERED" stylesheet="sbSystem:sb.node.properties.xsl" mimetype="text/html" />
		<action nodetype="sbFiles:Asset" view="render" id="onthefly" uselocale="TRUE" output="STREAM" />
		
		<nodetype id="sbFiles:Image" type="PRIMARY" taggable="TRUE" displaytype="sb_image" />
		<view nodetype="sbFiles:Image" id="preview" display="TRUE" order="1" class="sbView_image_preview" classfile="sbFiles:sb.node.image.view.preview" default="TRUE" />
		<view nodetype="sbFiles:Image" id="properties" display="TRUE" order="1" class="sbView_properties" classfile="sbSystem:sb.node.view.properties" />
		<view nodetype="sbFiles:Image" id="render" display="TRUE" order="1" class="sbView_asset_render" classfile="sbFiles:sb.node.asset.view.render" />
		<action nodetype="sbFiles:Image" view="preview" id="display" uselocale="TRUE" output="RENDERED" stylesheet="sbFiles:image.preview.xsl" mimetype="text/html" default="TRUE" />
		<action nodetype="sbFiles:Image" view="preview" id="output" uselocale="TRUE" output="STREAM" />
		<action nodetype="sbFiles:Image" view="preview" id="outputresized" uselocale="TRUE" output="STREAM" />
		<action nodetype="sbFiles:Image" view="properties" id="edit" uselocale="TRUE" output="RENDERED" stylesheet="sbSystem:sb.node.properties.xsl" mimetype="text/html" default="TRUE" />
		<action nodetype="sbFiles:Image" view="properties" id="save" uselocale="TRUE" output="RENDERED" stylesheet="sbSystem:sb.node.properties.xsl" mimetype="text/html" />
		<action nodetype="sbFiles:Image" view="render" id="onthefly" uselocale="TRUE" output="STREAM" default="TRUE" />
		
		<mode id="tree">
			<allow parent="sbSystem:Root" child="sbJukebox:Jukebox" />
			<allow parent="sbJukebox:Jukebox" child="sbJukebox:Playlist" />
			<allow parent="sbSystem:Layout" child="sbJukebox:TPL_Favorites" />
			<allow parent="sbSystem:Layout" child="sbJukebox:TPL_MostHeard" />
			<allow parent="sbSystem:Layout" child="sbJukebox:TPL_NowPlaying" />
			<allow parent="sbSystem:Layout" child="sbJukebox:TPL_TopRated" />
		</mode>
		<mode id="create">
			<allow parent="sbSystem:Root" child="sbJukebox:Jukebox" />
			<allow parent="sbJukebox:Album" child="sbSystem:Comment" />
			<allow parent="sbJukebox:Artist" child="sbSystem:Comment" />
			<allow parent="sbJukebox:Track" child="sbSystem:Comment" />
			<allow parent="sbJukebox:Playlist" child="sbSystem:Comment" />
			<allow parent="sbJukebox:Jukebox" child="sbJukebox:Playlist" />
			<allow parent="sbSystem:Layout" child="sbJukebox:TPL_Favorites" />
			<allow parent="sbSystem:Layout" child="sbJukebox:TPL_MostHeard" />
			<allow parent="sbSystem:Layout" child="sbJukebox:TPL_NowPlaying" />
			<allow parent="sbSystem:Layout" child="sbJukebox:TPL_TopRated" />
		</mode>
		<mode id="list">
			<allow parent="sbSystem:Root" child="sbJukebox:Jukebox" />
			<allow parent="sbJukebox:Jukebox" child="sbJukebox:Artist" />
			<allow parent="sbJukebox:Jukebox" child="sbJukebox:Playlist" />
			<allow parent="sbJukebox:Artist" child="sbJukebox:Album" />
			<allow parent="sbJukebox:Album" child="sbJukebox:Track" />
			<allow parent="sbJukebox:Playlist" child="sbJukebox:Track" />
			<allow parent="sbJukebox:Artist" child="sbSystem:Comment" />
			<allow parent="sbJukebox:Album" child="sbSystem:Comment" />
			<allow parent="sbJukebox:Track" child="sbSystem:Comment" />
			<allow parent="sbJukebox:Playlist" child="sbSystem:Comment" />
		</mode>
		<!--<mode id="chooseAlbum">
			<allow parent="sbSystem:Root" child="sbJukebox:Jukebox" />
			<allow parent="sbJukebox:Jukebox" child="sbJukebox:Artist" />
			<allow parent="sbJukebox:Artist" child="sbJukebox:Album" />
		</mode>-->
		<mode id="chooseArtist">
			<allow parent="sbSystem:Root" child="sbJukebox:Jukebox" />
			<allow parent="sbJukebox:Jukebox" child="sbJukebox:Artist" />
		</mode>
		<mode id="albums">
			<allow parent="sbJukebox:Artist" child="sbJukebox:Album" />
		</mode>
		<mode id="recommendations">
			<allow parent="sbSystem:Inbox" child="sbJukebox:Recommendation" />
		</mode>
		<mode id="tracks">
			<allow parent="sbJukebox:Album" child="sbJukebox:Track" />
			<allow parent="sbJukebox:Playlist" child="sbJukebox:Track" />
		</mode>

	</repository>
	
</sbXMLBatch>